define("local_requestlogger/formlogger",[],(function(){return{init:function(){console.log("Form logger initialized.");let fieldsetData={};function attachFieldsetListeners(form){form.querySelectorAll("fieldset input, fieldset select, fieldset textarea").forEach((element=>{element.hasAttribute("data-listener-attached")||(element.addEventListener("input",(function(){element.name&&(fieldsetData[element.name]=element.value)})),element.setAttribute("data-listener-attached","true"))}))}function logFormData(form){if(!form||form.dataset.loggedOnce)return;form.dataset.loggedOnce=(new Date).getTime(),setTimeout((()=>delete form.dataset.loggedOnce),1e3),attachFieldsetListeners(form);let formData=new FormData(form);for(let key in fieldsetData)fieldsetData.hasOwnProperty(key)&&!formData.has(key)&&formData.append(key,fieldsetData[key]);formData.append("submitted_at",(new Date).toISOString());let url=M.cfg.wwwroot+"/local/requestlogger/log.php";if(navigator.sendBeacon){let blob=new Blob([new URLSearchParams(formData)],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(url,blob)}else fetch(url,{method:"POST",body:formData,credentials:"same-origin"}).then((response=>response.json())).then((data=>console.log("✅ Log terkirim:",data))).catch((error=>console.error("❌ Gagal mengirim log:",error)))}document.addEventListener("submit",(function(event){let form=event.target;form.method&&"post"===form.method.toLowerCase()&&logFormData(form)}),!0),document.addEventListener("click",(function(event){let target=event.target.closest('button[data-action="save"]');if(!target)return;console.log("🟢 Tombol Save kalender ditekan:",target);let modal=document.querySelector(".modal.show");if(!modal)return void console.error("❌ Tidak menemukan modal yang terbuka.");let form=modal.querySelector(".mform");if(form)logFormData(form);else{console.error("❌ Form tidak ditemukan dalam modal, menunggu beberapa detik...");let waitForForm=setInterval((()=>{let newModal=document.querySelector(".modal.show");if(newModal){let newForm=newModal.querySelector(".mform");newForm&&(console.log("✅ Form ditemukan dalam modal setelah penundaan."),clearInterval(waitForForm),logFormData(newForm))}else clearInterval(waitForForm)}),300);setTimeout((()=>clearInterval(waitForForm)),3e3)}}),!0),document.addEventListener("click",(function(event){event.target.closest('button[data-action="new-event-button"]')&&(console.log("📌 Tombol 'New Event' ditekan, memantau modal..."),function(){console.log("🔍 Memulai observer modal kalender...");let observer=new MutationObserver((mutationsList=>{mutationsList.forEach((mutation=>{mutation.addedNodes.forEach((node=>{1===node.nodeType&&node.matches(".modal.show .mform")&&(console.log("✅ Form kalender muncul dalam modal, menambahkan listener..."),attachFieldsetListeners(node))})),mutation.removedNodes.forEach((node=>{1===node.nodeType&&node.matches(".modal.show")&&(console.log("🛑 Modal ditutup, menghentikan observer."),observer.disconnect())}))}))}));observer.observe(document.body,{childList:!0,subtree:!0})}())})),function(){let originalFetch=window.fetch;window.fetch=function(url,options){return console.log("📡 AJAX POST ke:",url),originalFetch.apply(this,arguments)}}()}}}));

//# sourceMappingURL=formlogger.min.js.map